<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Multiple Alleles · PhyloNetworks.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link href="../../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>PhyloNetworks.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../../">Home</a></li><li><span class="toctext">Manual</span><ul><li><a class="toctext" href="../installation/">Installation</a></li><li><a class="toctext" href="../inputdata/">Input Data for SNaQ</a></li><li><a class="toctext" href="../ticr_howtogetQuartetCFs/">TICR pipeline</a></li><li><a class="toctext" href="../snaq_plot/">Network estimation and display</a></li><li><a class="toctext" href="../dist_reroot/">Network comparison and manipulation</a></li><li><a class="toctext" href="../fixednetworkoptim/">Candidate Networks</a></li><li><a class="toctext" href="../expectedCFs/">Extract Expected CFs</a></li><li><a class="toctext" href="../bootstrap/">Bootstrap</a></li><li class="current"><a class="toctext" href>Multiple Alleles</a><ul class="internal"></ul></li><li><a class="toctext" href="../trait_tree/">Continuous Trait Evolution</a></li><li><a class="toctext" href="../parsimony/">Parsimony on networks</a></li></ul></li><li><span class="toctext">Library</span><ul><li><a class="toctext" href="../../lib/public/">Public</a></li><li><a class="toctext" href="../../lib/internals/">Internals</a></li></ul></li></ul></nav><article id="docs"><header><nav><ul><li>Manual</li><li><a href>Multiple Alleles</a></li></ul><a class="edit-page" href="https://github.com/crsl4/PhyloNetworks.jl/blob/master/docs/src/man/multiplealleles.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>Multiple Alleles</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="Multiple-alleles-per-species-1" href="#Multiple-alleles-per-species-1">Multiple alleles per species</a></h1><p>The default setting for SNaQ considers that each allele in a gene tree corresponds to a taxon (a tip) in the network. If instead each allele/individual can be mapped confidently to a species, and if only the species-level network needs to be estimated, then the following functions should be used:</p><pre><code class="language-julia">df_sp = mapAllelesCFtable(mappingFile, CFtable_ind);
d_sp = readTableCF!(df_sp);</code></pre><p>where the mapping file can be a text (or <code>csv</code>) file with two columns named <code>allele</code> and <code>species</code>, mapping each allele name to a species name. The CF table <code>CFtable_ind</code> should be a table of concordance factors at the level of individuals. In other words, it should list CFs using one row for each set of 4 alleles/individuals. The first command creates a new data frame <code>df_sp</code> of quartet concordance factors at the species level: with the allele names replaced by the appropriate species names.</p><p>The second command modifies this data frame <code>df_sp</code> by deleting rows that are uninformative about between-species relationships, such as rows corresponding to 4 individuals from the same species. The output <code>d_sp</code> of this second command is an object of type <code>DataCF</code> at the species level, which can be used as input for networks estimation with <code>snaq!</code>:</p><pre><code class="language-julia">net = snaq!(T_sp, d_sp);</code></pre><p>where <code>T_sp</code> should be a starting topology with one tip per species, labelled with the same species names as the names used in the mapping file.</p><p>Warnings:</p><ul><li>This feature has not been fully tested</li><li>This procedure is slow and should be made faster, when working with gene trees as input.</li><li>If input data are gene trees, the CF table at the individual level should be created first, like this:<pre><code class="language-julia">CFtable_ind = readTrees2CF(gene tree file);</code></pre>before applying the two commands above. At this time, however, this procedure requires that all alleles from the same individual are given the same name (the individual&#39;s &#39;name&#39;) across all genes for which that individual was sequenced.</li></ul><footer><hr/><a class="previous" href="../bootstrap/"><span class="direction">Previous</span><span class="title">Bootstrap</span></a><a class="next" href="../trait_tree/"><span class="direction">Next</span><span class="title">Continuous Trait Evolution</span></a></footer></article></body></html>
