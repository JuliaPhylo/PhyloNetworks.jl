<!DOCTYPE html>
<!--[if lt IE 7 ]><html class="no-js ie6"><![endif]-->
<!--[if IE 7 ]><html class="no-js ie7"><![endif]-->
<!--[if IE 8 ]><html class="no-js ie8"><![endif]-->
<!--[if IE 9 ]><html class="no-js ie9"><![endif]-->
<!--[if (gt IE 9)|!(IE)]><!--> <html class="no-js"> <!--<![endif]-->
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1,maximum-scale=1">
    
      
        <title>Internals - PhyloNetworks.jl</title>
      
      
      
      
        <meta name="author" content="Claudia Sol&iacute;s-Lemus">
      
    
    <meta property="og:url" content="None">
    <meta property="og:title" content="PhyloNetworks.jl">
    <meta property="og:image" content="None/../../snaq_small.png">
    <meta name="apple-mobile-web-app-title" content="PhyloNetworks.jl">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    
      <link rel="apple-touch-icon" href="../../snaq_small.png">
    
    
    <link rel="shortcut icon" type="image/x-icon" href="../../assets/images/favicon-e565ddfa3b.ico">
    <link rel="icon" type="image/x-icon" href="../../assets/images/favicon-e565ddfa3b.ico">
    <style>
      @font-face {
      	font-family: 'Icon';
      	src: url('../../assets/fonts/icon.eot?52m981');
      	src: url('../../assets/fonts/icon.eot?#iefix52m981')
               format('embedded-opentype'),
      		   url('../../assets/fonts/icon.woff?52m981')
               format('woff'),
      		   url('../../assets/fonts/icon.ttf?52m981')
               format('truetype'),
      		   url('../../assets/fonts/icon.svg?52m981#icon')
               format('svg');
      	font-weight: normal;
      	font-style: normal;
      }
    </style>
    <link rel="stylesheet" href="../../assets/stylesheets/application-a422ff04cc.css">
    
      <link rel="stylesheet" href="../../assets/stylesheets/palettes-05ab2406df.css">
    
    
      
      
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Ubuntu:400,700|Ubuntu+Mono">
      <style>
        body, input {
          font-family: 'Ubuntu', Helvetica, Arial, sans-serif;
        }
        pre, code {
          font-family: 'Ubuntu Mono', 'Courier New', 'Courier', monospace;
        }
      </style>
    
    
      <link rel="stylesheet" href="../../assets/Documenter.css">
    
    <script src="../../assets/javascripts/modernizr-4ab42b99fd.js"></script>
    
  </head>
  
  
  
  <body class="palette-primary-teal palette-accent-teal">
    
      
      
    
    <div class="backdrop">
      <div class="backdrop-paper"></div>
    </div>
    <input class="toggle" type="checkbox" id="toggle-drawer">
    <input class="toggle" type="checkbox" id="toggle-search">
    <label class="toggle-button overlay" for="toggle-drawer"></label>
    <header class="header">
      <nav aria-label="Header">
  <div class="bar default">
    <div class="button button-menu" role="button" aria-label="Menu">
      <label class="toggle-button icon icon-menu" for="toggle-drawer">
        <span></span>
      </label>
    </div>
    <div class="stretch">
      <div class="title">
        
          <span class="path">
            
              
                Library <i class="icon icon-link"></i>
              
            
          </span>
        
        Internals
      </div>
    </div>
    
    
    <div class="button button-search" role="button" aria-label="Search">
      <label class="toggle-button icon icon-search" title="Search" for="toggle-search"></label>
    </div>
  </div>
  <div class="bar search">
    <div class="button button-close" role="button" aria-label="Close">
      <label class="toggle-button icon icon-back" for="toggle-search"></label>
    </div>
    <div class="stretch">
      <div class="field">
        <input class="query" type="text" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck>
      </div>
    </div>
    <div class="button button-reset" role="button" aria-label="Search">
      <button class="toggle-button icon icon-close" id="reset-search"></button>
    </div>
  </div>
</nav>
    </header>
    <main class="main">
      
      <div class="drawer">
        <nav aria-label="Navigation">
  
  <a href="https://github.com/crsl4/PhyloNetworks.jl" class="project">
    <div class="banner">
      
        <div class="logo">
          <img src="../../snaq_small.png">
        </div>
      
      <div class="name">
        <strong>
          PhyloNetworks.jl
          <span class="version">
            
          </span>
        </strong>
        
          <br>
          crsl4/PhyloNetworks.jl
        
      </div>
    </div>
  </a>
  <div class="scrollable">
    <div class="wrapper">
      
        <ul class="repo">
          <li class="repo-download">
            
            <a href="https://github.com/crsl4/PhyloNetworks.jl/archive/master.zip" target="_blank" title="Download" data-action="download">
              <i class="icon icon-download"></i> Download
            </a>
          </li>
          <li class="repo-stars">
            <a href="https://github.com/crsl4/PhyloNetworks.jl/stargazers" target="_blank" title="Stargazers" data-action="star">
              <i class="icon icon-star"></i> Stars
              <span class="count">&ndash;</span>
            </a>
          </li>
        </ul>
        <hr>
      
      <div class="toc">
        <ul>
          
            
  <li>
    <a class="" title="Home" href="../..">
      Home
    </a>
    
  </li>

          
            
  <li>
    <span class="section">Manual</span>
    <ul>
      
        
  <li>
    <a class="" title="Installation" href="../../man/installation/">
      Installation
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Input Data for SNaQ" href="../../man/inputdata/">
      Input Data for SNaQ
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="TICR pipeline" href="../../man/ticr_howtogetQuartetCFs/">
      TICR pipeline
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Network estimation and display" href="../../man/snaq_plot/">
      Network estimation and display
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Fixed Network" href="../../man/fixednetworkoptim/">
      Fixed Network
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Extract Expected CFs" href="../../man/expectedCFs/">
      Extract Expected CFs
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Bootstrap" href="../../man/bootstrap/">
      Bootstrap
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Multiple Alleles" href="../../man/multiplealleles/">
      Multiple Alleles
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Trait Evolution" href="../../man/trait_tree/">
      Trait Evolution
    </a>
    
  </li>

      
    </ul>
  </li>

          
            
  <li>
    <span class="section">Library</span>
    <ul>
      
        
  <li>
    <a class="" title="Public" href="../public/">
      Public
    </a>
    
  </li>

      
        
  <li>
    <a class="current" title="Internals" href="./">
      Internals
    </a>
    
      
        
      
      
        <ul>
          
            <li class="anchor">
              <a title="Contents" href="#contents">
                Contents
              </a>
            </li>
          
            <li class="anchor">
              <a title="Index" href="#index">
                Index
              </a>
            </li>
          
            <li class="anchor">
              <a title="Types" href="#types">
                Types
              </a>
            </li>
          
            <li class="anchor">
              <a title="Functions and methods" href="#functions-and-methods">
                Functions and methods
              </a>
            </li>
          
        </ul>
      
    
  </li>

      
    </ul>
  </li>

          
        </ul>
        
      </div>
    </div>
  </div>
</nav>
      </div>
      <article class="article">
        <div class="wrapper">
          
          <p><a id='Internal-Documentation-1'></a></p>
<h1 id="internal-documentation">Internal Documentation</h1>
<p><a id='Contents-1'></a></p>
<h2 id="contents">Contents</h2>
<ul>
<li><a href="./#Internal-Documentation-1">Internal Documentation</a><ul>
<li><a href="./#Contents-1">Contents</a></li>
<li><a href="./#Index-1">Index</a></li>
<li><a href="./#Types-1">Types</a></li>
<li><a href="./#Functions-and-methods-1">Functions and methods</a></li>
</ul>
</li>
</ul>
<p><a id='Index-1'></a></p>
<h2 id="index">Index</h2>
<ul>
<li><a href="./#PhyloNetworks.ANode"><code>PhyloNetworks.ANode</code></a></li>
<li><a href="./#PhyloNetworks.MatrixTopologicalOrder"><code>PhyloNetworks.MatrixTopologicalOrder</code></a></li>
<li><a href="./#Base.getindex-Tuple{PhyloNetworks.MatrixTopologicalOrder,Symbol}"><code>Base.getindex</code></a></li>
<li><a href="./#PhyloNetworks.assignhybridnames!"><code>PhyloNetworks.assignhybridnames!</code></a></li>
<li><a href="./#PhyloNetworks.deleteNode!"><code>PhyloNetworks.deleteNode!</code></a></li>
<li><a href="./#PhyloNetworks.sampleBootstrapTrees"><code>PhyloNetworks.sampleBootstrapTrees</code></a></li>
<li><a href="./#PhyloNetworks.sampleCFfromCI"><code>PhyloNetworks.sampleCFfromCI</code></a></li>
<li><a href="./#PhyloNetworks.setNonIdBL!"><code>PhyloNetworks.setNonIdBL!</code></a></li>
<li><a href="./#PhyloNetworks.sharedPathMatrix"><code>PhyloNetworks.sharedPathMatrix</code></a></li>
</ul>
<p><a id='Types-1'></a></p>
<h2 id="types">Types</h2>
<p><a id='PhyloNetworks.ANode' href='#PhyloNetworks.ANode'>#</a>
<strong><code>PhyloNetworks.ANode</code></strong> &mdash; <em>Type</em>.</p>
<p><code>ANode</code></p>
<p>Abstract node. An object of type <code>Edge</code> has a <code>node</code> attribute, which is an vector of (2) ANode objects. The object of type <code>Node</code> is an <code>ANode</code>, and has an <code>edge</code> attribute, which is vector of <code>Edge</code> objects.</p>
<p><a target='_blank' href='https://github.com/crsl4/PhyloNetworks.jl/tree/9898feb7fb54edb5ce72067b750f5763648950b5/src/types.jl#L17-L24' class='documenter-source'>source</a><br></p>
<p><a id='PhyloNetworks.MatrixTopologicalOrder' href='#PhyloNetworks.MatrixTopologicalOrder'>#</a>
<strong><code>PhyloNetworks.MatrixTopologicalOrder</code></strong> &mdash; <em>Type</em>.</p>
<p><code>MatrixTopologicalOrder</code></p>
<p>Matrix associated to an <a href="../public/#PhyloNetworks.HybridNetwork"><code>HybridNetwork</code></a> sorted in topological order.</p>
<p>The following functions and extractors can be applied to it: <a href="../public/#PhyloNetworks.tipLabels"><code>tipLabels</code></a>, <code>obj[:Tips]</code>, <code>obj[:InternalNodes]</code>, <code>obj[:TipsNodes]</code> (see documentation for function <a href="./#Base.getindex-Tuple{PhyloNetworks.MatrixTopologicalOrder,Symbol}"><code>getindex(::MatrixTopologicalOrder, ::Symbol)</code></a>).</p>
<p>Functions <a href="./#PhyloNetworks.sharedPathMatrix"><code>sharedPathMatrix</code></a> and <a href="../public/#PhyloNetworks.simulate"><code>simulate</code></a> return objects of this type.</p>
<p>The <code>MatrixTopologicalOrder</code> object has fields: <code>V</code>, <code>nodeNumbersTopOrder</code>, <code>internalNodeNumbers</code>, <code>tipNumbers</code>, <code>tipNames</code>, <code>indexation</code>. Type in "?MatrixTopologicalOrder.field" to get documentation on a specific field.</p>
<p><a target='_blank' href='https://github.com/crsl4/PhyloNetworks.jl/tree/9898feb7fb54edb5ce72067b750f5763648950b5/src/traits.jl#L11-L22' class='documenter-source'>source</a><br></p>
<p><a id='Functions-and-methods-1'></a></p>
<h2 id="functions-and-methods">Functions and methods</h2>
<p><a id='PhyloNetworks.assignhybridnames!' href='#PhyloNetworks.assignhybridnames!'>#</a>
<strong><code>PhyloNetworks.assignhybridnames!</code></strong> &mdash; <em>Function</em>.</p>
<p><code>assignhybridnames!(net)</code></p>
<p>Assign names to hybrid nodes in the network <code>net</code>. Hybrid nodes with an empty <code>name</code> field ("") are modified with a name that does not conflict with other hybrid names in the network. The preferred name is "#H3" if the node number is 3 or -3, but an index other than 3 would be used if "#H3" were the name of another hybrid node already.</p>
<p>If two hybrid nodes have non-empty and equal names, the name of one of them is changed and re-assigned as described above (with a warning).</p>
<p><a target='_blank' href='https://github.com/crsl4/PhyloNetworks.jl/tree/9898feb7fb54edb5ce72067b750f5763648950b5/src/auxiliary.jl#L1160-L1170' class='documenter-source'>source</a><br></p>
<p><a id='PhyloNetworks.deleteNode!' href='#PhyloNetworks.deleteNode!'>#</a>
<strong><code>PhyloNetworks.deleteNode!</code></strong> &mdash; <em>Function</em>.</p>
<p><code>deleteNode!(net::HybridNetwork, n::Node)</code></p>
<p>deletes a Node from a network, i.e. removes it from net.node, and from net.hybrid or net.leaf as appropriate. Updates attributes numNodes, numTaxa, numHybrids (it does not update net.names though).</p>
<p>Warning: if the root is deleted, the new root is arbitrarily set to the first node in the list. This is intentional to save time because this function is used frequently in snaq!, which handles semi-directed (unrooted) networks.</p>
<p><a target='_blank' href='https://github.com/crsl4/PhyloNetworks.jl/tree/9898feb7fb54edb5ce72067b750f5763648950b5/src/auxiliary.jl#L394-L406' class='documenter-source'>source</a><br></p>
<p><a id='PhyloNetworks.sampleBootstrapTrees' href='#PhyloNetworks.sampleBootstrapTrees'>#</a>
<strong><code>PhyloNetworks.sampleBootstrapTrees</code></strong> &mdash; <em>Function</em>.</p>
<pre><code>sampleBootstrapTrees(vector of tree lists; seed=0::Integer, generesampling=false, row=0)
sampleBootstrapTrees!(tree list, vector of tree lists; seed=0::Integer, generesampling=false, row=0)
</code></pre>

<p>Sample bootstrap gene trees, 1 tree per gene. Set the seed with keyword argument <code>seed</code>, which is 0 by default. When <code>seed=0</code>, the actual seed is set using the clock. Assumes a vector of vectors of networks (see <code>readBootstrapTrees</code>), each one of length 1 or more (error if one vector is empty, tested in <code>bootsnaq</code>).</p>
<ul>
<li>site resampling: always, from sampling one bootstrap tree from each given list. This tree is sampled at <strong>random</strong> unless <code>row&gt;0</code> (see below).</li>
<li>gene resampling: if <code>generesampling=true</code> (default is false), genes (i.e. lists) are sampled with replacement.</li>
<li><code>row=i</code>: samples the ith bootstrap tree for each gene. <code>row</code> is turned back to 0 if gene resampling is true.</li>
</ul>
<p>output: one vector of trees. the modifying function (!) modifies the input tree list and returns it.</p>
<p><a target='_blank' href='https://github.com/crsl4/PhyloNetworks.jl/tree/9898feb7fb54edb5ce72067b750f5763648950b5/src/bootstrap.jl#L29-L47' class='documenter-source'>source</a><br></p>
<p><a id='PhyloNetworks.sampleCFfromCI' href='#PhyloNetworks.sampleCFfromCI'>#</a>
<strong><code>PhyloNetworks.sampleCFfromCI</code></strong> &mdash; <em>Function</em>.</p>
<pre><code>sampleCFfromCI(data frame, seed=0)
sampleCFfromCI!(data frame, seed=0)
</code></pre>

<p>Read a data frame containing CFs and their credibility intervals, and sample new obsCF uniformly within the CIs. These CFs are then rescaled to sum up to 1 for each 4-taxon sets. Return a data frame with taxon labels in first 4 columns, sampled obs CFs in columns 5-7 and credibility intervals in columns 8-13.</p>
<ul>
<li>The non-modifying function creates a new data frame (with re-ordered columns) and returns it. If <code>seed=-1</code>, the new df is a deep copy of the input df, with no call to the random number generator. Otherwise, <code>seed</code> is passed to the modifying function.</li>
<li>The modifying function overwrites the input data frame with the sampled CFs and returns it. If <code>seed=0</code>, the random generator is seeded from the clock. Otherwise the random generator is seeded using <code>seed</code>.</li>
</ul>
<p>Warning: the modifying version does <em>not</em> check the df: assumes correct columns.</p>
<p><a target='_blank' href='https://github.com/crsl4/PhyloNetworks.jl/tree/9898feb7fb54edb5ce72067b750f5763648950b5/src/bootstrap.jl#L86-L104' class='documenter-source'>source</a><br></p>
<p><a id='PhyloNetworks.setNonIdBL!' href='#PhyloNetworks.setNonIdBL!'>#</a>
<strong><code>PhyloNetworks.setNonIdBL!</code></strong> &mdash; <em>Function</em>.</p>
<p><code>setNonIdBL!(net)</code></p>
<p>Set non-identifiable edge branch lengths to -1.0 (i.e. missing) for a level-1 network <code>net</code>, except for edges in</p>
<ul>
<li>a good triangle: the edge below the hybrid is constrained to 0.</li>
<li>a bad diamond II: the edge below the hybrid is constrained to 0</li>
<li>a bad diamond I: the edges across from the hybrid node have non identifiable lengths but are kept, because the two Î³*(1-exp(-t)) values are identifiable.</li>
</ul>
<p>will break if <code>inCycle</code> attributes are not initialized (at -1) or giving a correct node number.</p>
<p><a target='_blank' href='https://github.com/crsl4/PhyloNetworks.jl/tree/9898feb7fb54edb5ce72067b750f5763648950b5/src/descriptive.jl#L68-L80' class='documenter-source'>source</a><br></p>
<p><a id='PhyloNetworks.sharedPathMatrix' href='#PhyloNetworks.sharedPathMatrix'>#</a>
<strong><code>PhyloNetworks.sharedPathMatrix</code></strong> &mdash; <em>Function</em>.</p>
<p><code>sharedPathMatrix(net::HybridNetwork; checkPreorder=true::Bool)</code></p>
<p>This function computes the shared path matrix between all the nodes of a network. It assumes that the network is in the pre-order. If checkPreorder is true (default), then it runs function <code>preoder</code> on the network beforehand.</p>
<p>Returns an object of type <a href="./#PhyloNetworks.MatrixTopologicalOrder"><code>MatrixTopologicalOrder</code></a>.</p>
<p><a target='_blank' href='https://github.com/crsl4/PhyloNetworks.jl/tree/9898feb7fb54edb5ce72067b750f5763648950b5/src/traits.jl#L215-L224' class='documenter-source'>source</a><br></p>
<p><a id='Base.getindex-Tuple{PhyloNetworks.MatrixTopologicalOrder,Symbol}' href='#Base.getindex-Tuple{PhyloNetworks.MatrixTopologicalOrder,Symbol}'>#</a>
<strong><code>Base.getindex</code></strong> &mdash; <em>Method</em>.</p>
<pre><code>getindex(collection, key...)
</code></pre>

<p>Retrieve the value(s) stored at the given key or index within a collection. The syntax <code>a[i,j,...]</code> is converted by the compiler to <code>getindex(a, i, j, ...)</code>.</p>
<p><a target='_blank' href='https://github.com/JuliaLang/julia/tree/3c9d75391c72d7c32eea75ff187ce77b2d5effc8/base/docs/helpdb/Base.jl#L466-L471' class='documenter-source'>source</a><br></p>
<p><code>getindex(obj, d,[ indTips, msng])</code></p>
<p>Getting submatrices of an object of type <a href="./#PhyloNetworks.MatrixTopologicalOrder"><code>MatrixTopologicalOrder</code></a>.</p>
<p><strong>Arguments</strong></p>
<ul>
<li><code>obj::MatrixTopologicalOrder</code>: the matrix from which to extract.</li>
<li>
<p><code>d::Symbol</code>: a symbol precising which sub-matrix to extract. Can be:</p>
<ul>
<li><code>:Tips</code> columns and/or rows corresponding to the tips</li>
<li><code>:InternalNodes</code> columns and/or rows corresponding to the internal nodes</li>
<li><code>:TipsNodes</code> columns corresponding to internal nodes, and row to tips (works only is indexation="b")</li>
<li><code>indTips::Vector{Int}</code>: optional argument precising a specific order for the tips (internal use).</li>
<li><code>msng::BitArray{1}</code>: optional argument precising the missing tips (internal use).</li>
</ul>
</li>
</ul>
<p><a target='_blank' href='https://github.com/crsl4/PhyloNetworks.jl/tree/9898feb7fb54edb5ce72067b750f5763648950b5/src/traits.jl#L159-L173' class='documenter-source'>source</a><br></p>
          <aside class="copyright" role="note">
            
            Documentation built with
            <a href="http://www.mkdocs.org" target="_blank">MkDocs</a>
            using the
            <a href="http://squidfunk.github.io/mkdocs-material/" target="_blank">
              Material
            </a>
            theme.
          </aside>
          
            <footer class="footer">
              
  <nav class="pagination" aria-label="Footer">
    <div class="previous">
      
        <a href="../public/" title="Public">
          <span class="direction">
            Previous
          </span>
          <div class="page">
            <div class="button button-previous" role="button" aria-label="Previous">
              <i class="icon icon-back"></i>
            </div>
            <div class="stretch">
              <div class="title">
                Public
              </div>
            </div>
          </div>
        </a>
      
    </div>
    <div class="next">
      
    </div>
  </nav>

            </footer>
          
        </div>
      </article>
      <div class="results" role="status" aria-live="polite">
        <div class="scrollable">
          <div class="wrapper">
            <div class="meta"></div>
            <div class="list"></div>
          </div>
        </div>
      </div>
    </main>
    <script>
      var base_url = '../..';
      var repo_id  = 'crsl4/PhyloNetworks.jl';
    </script>
    <script src="../../assets/javascripts/application-997097ee0c.js"></script>
    
      <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
      <script src="../../assets/mathjaxhelper.js"></script>
    
    
  </body>
</html>