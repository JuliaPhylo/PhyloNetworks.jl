<!DOCTYPE html>
<!--[if lt IE 7 ]><html class="no-js ie6"><![endif]-->
<!--[if IE 7 ]><html class="no-js ie7"><![endif]-->
<!--[if IE 8 ]><html class="no-js ie8"><![endif]-->
<!--[if IE 9 ]><html class="no-js ie9"><![endif]-->
<!--[if (gt IE 9)|!(IE)]><!--> <html class="no-js"> <!--<![endif]-->
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1,maximum-scale=1">
    
      
        <title>Bootstrap - PhyloNetworks.jl</title>
      
      
      
      
        <meta name="author" content="Claudia Sol&iacute;s-Lemus">
      
    
    <meta property="og:url" content="None">
    <meta property="og:title" content="PhyloNetworks.jl">
    <meta property="og:image" content="None/../../snaq_small.png">
    <meta name="apple-mobile-web-app-title" content="PhyloNetworks.jl">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    
      <link rel="apple-touch-icon" href="../../snaq_small.png">
    
    
    <link rel="shortcut icon" type="image/x-icon" href="../../assets/images/favicon-e565ddfa3b.ico">
    <link rel="icon" type="image/x-icon" href="../../assets/images/favicon-e565ddfa3b.ico">
    <style>
      @font-face {
      	font-family: 'Icon';
      	src: url('../../assets/fonts/icon.eot?52m981');
      	src: url('../../assets/fonts/icon.eot?#iefix52m981')
               format('embedded-opentype'),
      		   url('../../assets/fonts/icon.woff?52m981')
               format('woff'),
      		   url('../../assets/fonts/icon.ttf?52m981')
               format('truetype'),
      		   url('../../assets/fonts/icon.svg?52m981#icon')
               format('svg');
      	font-weight: normal;
      	font-style: normal;
      }
    </style>
    <link rel="stylesheet" href="../../assets/stylesheets/application-a422ff04cc.css">
    
      <link rel="stylesheet" href="../../assets/stylesheets/palettes-05ab2406df.css">
    
    
      
      
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Ubuntu:400,700|Ubuntu+Mono">
      <style>
        body, input {
          font-family: 'Ubuntu', Helvetica, Arial, sans-serif;
        }
        pre, code {
          font-family: 'Ubuntu Mono', 'Courier New', 'Courier', monospace;
        }
      </style>
    
    
      <link rel="stylesheet" href="../../assets/Documenter.css">
    
    <script src="../../assets/javascripts/modernizr-4ab42b99fd.js"></script>
    
  </head>
  
  
  
  <body class="palette-primary-teal palette-accent-teal">
    
      
      
    
    <div class="backdrop">
      <div class="backdrop-paper"></div>
    </div>
    <input class="toggle" type="checkbox" id="toggle-drawer">
    <input class="toggle" type="checkbox" id="toggle-search">
    <label class="toggle-button overlay" for="toggle-drawer"></label>
    <header class="header">
      <nav aria-label="Header">
  <div class="bar default">
    <div class="button button-menu" role="button" aria-label="Menu">
      <label class="toggle-button icon icon-menu" for="toggle-drawer">
        <span></span>
      </label>
    </div>
    <div class="stretch">
      <div class="title">
        
          <span class="path">
            
              
                Manual <i class="icon icon-link"></i>
              
            
          </span>
        
        Bootstrap
      </div>
    </div>
    
    
    <div class="button button-search" role="button" aria-label="Search">
      <label class="toggle-button icon icon-search" title="Search" for="toggle-search"></label>
    </div>
  </div>
  <div class="bar search">
    <div class="button button-close" role="button" aria-label="Close">
      <label class="toggle-button icon icon-back" for="toggle-search"></label>
    </div>
    <div class="stretch">
      <div class="field">
        <input class="query" type="text" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck>
      </div>
    </div>
    <div class="button button-reset" role="button" aria-label="Search">
      <button class="toggle-button icon icon-close" id="reset-search"></button>
    </div>
  </div>
</nav>
    </header>
    <main class="main">
      
      <div class="drawer">
        <nav aria-label="Navigation">
  
  <a href="https://github.com/crsl4/PhyloNetworks.jl" class="project">
    <div class="banner">
      
        <div class="logo">
          <img src="../../snaq_small.png">
        </div>
      
      <div class="name">
        <strong>
          PhyloNetworks.jl
          <span class="version">
            
          </span>
        </strong>
        
          <br>
          crsl4/PhyloNetworks.jl
        
      </div>
    </div>
  </a>
  <div class="scrollable">
    <div class="wrapper">
      
        <ul class="repo">
          <li class="repo-download">
            
            <a href="https://github.com/crsl4/PhyloNetworks.jl/archive/master.zip" target="_blank" title="Download" data-action="download">
              <i class="icon icon-download"></i> Download
            </a>
          </li>
          <li class="repo-stars">
            <a href="https://github.com/crsl4/PhyloNetworks.jl/stargazers" target="_blank" title="Stargazers" data-action="star">
              <i class="icon icon-star"></i> Stars
              <span class="count">&ndash;</span>
            </a>
          </li>
        </ul>
        <hr>
      
      <div class="toc">
        <ul>
          
            
  <li>
    <a class="" title="Home" href="../..">
      Home
    </a>
    
  </li>

          
            
  <li>
    <span class="section">Manual</span>
    <ul>
      
        
  <li>
    <a class="" title="Installation" href="../installation/">
      Installation
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Input Data for SNaQ" href="../inputdata/">
      Input Data for SNaQ
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="TICR pipeline" href="../ticr_howtogetQuartetCFs/">
      TICR pipeline
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Network estimation and display" href="../snaq_plot/">
      Network estimation and display
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Fixed Network" href="../fixednetworkoptim/">
      Fixed Network
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Extract Expected CFs" href="../expectedCFs/">
      Extract Expected CFs
    </a>
    
  </li>

      
        
  <li>
    <a class="current" title="Bootstrap" href="./">
      Bootstrap
    </a>
    
      
        
      
      
        <ul>
          
            <li class="anchor">
              <a title="Running a bootstrap analysis" href="#running-a-bootstrap-analysis">
                Running a bootstrap analysis
              </a>
            </li>
          
            <li class="anchor">
              <a title="Summarizing bootstrap on the main tree" href="#summarizing-bootstrap-on-the-main-tree">
                Summarizing bootstrap on the main tree
              </a>
            </li>
          
            <li class="anchor">
              <a title="Summarizing bootstrap on reticulations" href="#summarizing-bootstrap-on-reticulations">
                Summarizing bootstrap on reticulations
              </a>
            </li>
          
        </ul>
      
    
  </li>

      
        
  <li>
    <a class="" title="Multiple Alleles" href="../multiplealleles/">
      Multiple Alleles
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Trait Evolution" href="../trait_tree/">
      Trait Evolution
    </a>
    
  </li>

      
    </ul>
  </li>

          
            
  <li>
    <span class="section">Library</span>
    <ul>
      
        
  <li>
    <a class="" title="Public" href="../../lib/public/">
      Public
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Internals" href="../../lib/internals/">
      Internals
    </a>
    
  </li>

      
    </ul>
  </li>

          
        </ul>
        
      </div>
    </div>
  </div>
</nav>
      </div>
      <article class="article">
        <div class="wrapper">
          
          <p><a id='Bootstrap-1'></a></p>
<h1 id="bootstrap">Bootstrap</h1>
<p><a id='Running-a-bootstrap-analysis-1'></a></p>
<h2 id="running-a-bootstrap-analysis">Running a bootstrap analysis</h2>
<p>We can run a bootstrap analysis if we estimated quartet concordance factors (CFs) with credibility intervals, such as if we used the <a href="../ticr_howtogetQuartetCFs/#TICR-pipeline-1">TICR pipeline</a>. This pipeline provides a CF table with extra columns for credibility intervals.</p>
<pre><code class="julia">using DataFrames
df = readtable(&quot;tableCFCI.csv&quot;)
bootnet = bootsnaq(T, df, hmax=1, nrep=10, runs=3, filename=&quot;bootstrap&quot;)
</code></pre>

<p>This example file can be accessed <a href="https://github.com/crsl4/PhyloNetworks/blob/master/examples/tableCFCI.csv">here</a> or <a href="https://raw.githubusercontent.com/crsl4/PhyloNetworks/master/examples/tableCFCI.csv">here</a>. Make sure that your downloaded file has the name <code>tableCFCI.csv</code> (to match the name in the Julia command), with no an extra extension <code>.txt</code>. Rename the file after download if necessary.</p>
<p>This example uses a number of replicates (10) that is definitely too small, to make the example run faster. You might also increase the number of optimization runs (<code>runs</code>) done for each bootstrap replicate.</p>
<p>The bootstrap networks are saved in the <code>boostrap.out</code> file, so they can be read in a new session with <code>bootnet = readMultiTopology("boostrap.out")</code>. To save the bootstrap networks to a different file (perhaps after having re-rooted them with an outgroup), you can do this:</p>
<pre><code class="julia">writeMultiTopology(bootnet, &quot;bootstrapNets_h1.tre&quot;)
length(bootnet) # 10 networks in the array 'bootnet'
less(&quot;bootstrapNets_h1.tre&quot;)
</code></pre>

<p>If you close your session and re-open it later, you can re-read the bootstrap networks back in memory like this:</p>
<pre><code class="julia">bootnet = readMultiTopology(&quot;bootstrapNets_h1.tre&quot;);
</code></pre>

<p>We can run bootstrap analysis from gene trees also. We need a text file with a list of files containg the bootstrap trees (one file per gene). This is the same format used by ASTRAL (see the wiki page for more details.).</p>
<pre><code class="julia">bootTrees = readBootstrapTrees(&quot;BSlistfiles&quot;)
bootnet = bootsnaq(T, bootTrees, hmax=1, nrep=100, filename=&quot;bootsnaq1_raxmlboot&quot;)
</code></pre>

<p>If you used a specified list of quartets on the original data, you should use that same list for the bootstrap analysis through the option <code>quartetfile</code>.</p>
<p><a id='Summarizing-bootstrap-on-the-main-tree-1'></a></p>
<h2 id="summarizing-bootstrap-on-the-main-tree">Summarizing bootstrap on the main tree</h2>
<p>The <code>bootsnaq</code> function, as used before, returned a list of 10 networks (<code>nrep=10</code>). Before summarizing them on the best network, it is best to re-read this network to get a reproducible internal numbering of its nodes and edges, used later for mapping bootstrap support to edges. We can then summarize bootstrap networks:</p>
<pre><code class="julia">net1 = readTopology(&quot;net1_snaq.out&quot;) # reading from output file of snaq
BStable, tree1 = treeEdgesBootstrap(bootnet,net1)
</code></pre>

<p>This will calculate the major tree <code>tree1</code> displayed in <code>net1</code>, that is, the tree obtained by following the major parent (γ&gt;0.5) of each hybrid node. This tree can be visualized like this, with edge numbers shown for later use.</p>
<pre><code class="julia">rootatnode!(net1, &quot;4&quot;)
rootatnode!(tree1, &quot;4&quot;)
plot(tree1, showEdgeNumber=true)
</code></pre>

<p>Next, we can look at bootstrap table <code>BStable</code>, which has one row for each tree edge in <code>net1</code>. One column contains the edge number (same as shown in the plot) and another column contains the edge bootstrap support: the proportion of bootstrap replicates in which this edge was found in the major tree of the inferred network. We can see the full bootstrap table and see which tree edges have bootstrap support lower than 100% with</p>
<pre><code class="julia">showall(BStable)
BStable[BStable[:proportion] .&lt; 1.0, :]
</code></pre>

<p>Finally, we can map the bootstrap proportions onto the network or its main tree by passing the bootstrap table to the <code>edgeLabel</code> option of <code>plot</code>:</p>
<pre><code class="julia">plot(tree1, edgeLabel=BStable)
plot(net1,  edgeLabel=BStable)
</code></pre>

<p>(Here, it is important that the numbers assigned to edges when building the boostrap table –those in <code>net1</code> at the time– correspond to the current edge numbers in <code>tree1</code> and <code>net1</code>. That was the purpose of reading the network from the output file of snaq! earlier, for consistency across different Julia sessions.)</p>
<p>If we wanted to plot only certain bootstrap values, like those below 100% (1.0), we could do this:</p>
<pre><code class="julia">plot(net1, edgeLabel=BStable[BStable[:proportion] .&lt; 1.0, :])
</code></pre>

<p><a id='Summarizing-bootstrap-on-reticulations-1'></a></p>
<h2 id="summarizing-bootstrap-on-reticulations">Summarizing bootstrap on reticulations</h2>
<p>Summarizing the placement of hybridization edges is not standard. The function <code>hybridBootstrapSupport</code> attempts to do so. The descendants of a given hybrid node form the "recipient" or "hybrid" clade, and is obtained after removing all other reticulations. If reticulation is due to gene flow or introgression, the minor hybrid edge (with γ&lt;0.5) represents this event. The descendants of the lineage from which gene flow originated is then a second "sister" of the hybrid clade. Because of the reticulation event, the hybrid clade has 2 sister clades, not 1: the major sister (through the major hybrid edge with γ&gt;0.5) and the minor sister (through the minor hybrid edge with γ&lt;0.5). Note that the network says <em>nothing</em> about the process: its shows the <em>relationships</em> only. We can calculate the frequency that each clade is a hybrid clade, or a major or minor sister for some other hybrid, in the bootstrap networks:</p>
<pre><code class="julia">BSn, BSe, BSc, BSgam, BSedgenum = hybridBootstrapSupport(bootnet, net1);
</code></pre>

<p>Let's look at the results. We can list all the clades and the percentage of bootstrap networks (bootstrap support) in which each clade is a hybrid or sister to a hybrid:</p>
<pre><code class="julia">BSn
</code></pre>

<p>If a clade contains a single taxon, it is listed with its taxon name. The clade found in the best network is listed with its tag, starting with H (e.g. "H7"). The name of other clades start with "c_" followed by their number in the best network, if they do appear in the best network. The node numbers, as used internally in the best network, are listed in a separate column. They can be used later to display the bootstrap support values onto the network. Various columns give the bootstrap support that each clade is a hybrid, or a (major/minor) sister to a hybrid. The last column gives the bootstrap support for the full relationship in the best network: same hybrid with same two sisters. These bootstrap values are associated with nodes (or possibly, their parent edges).</p>
<p>To see what is the clade named "H7", for instance:</p>
<pre><code class="julia">BSc # this might be too big
showall(BSc)
BSc[:taxa][BSc[:H7]]
</code></pre>

<p>We can also get bootstrap values associated with edges, to describe the support that a given hybrid clade has a given sister clade.</p>
<pre><code class="julia">BSe
</code></pre>

<p>Here, each row describes a pair of 2 clades: one being the hybrid, the other being its sister, connected by a hybrid edge. The first rows corresponds to hybrid edges in the best network. Other rows correspond to edges seen in bootstrap networks but not in the best network.</p>
<pre><code class="julia">BSedgenum
</code></pre>

<p>lists all the hybrid edges in the best network, two for each hybrid node: the major parent edge and then the minor parent edge. In our case, there is only one reticulation, so only 2 hybrid edges.</p>
<p>We can plot the bootstrap values of the 2 hybrid edges in the best network:</p>
<pre><code class="julia">plot(net1, edgeLabel=BSe[[:edge,:BS_hybrid_edge]])
</code></pre>

<p>This is showing the bootstrap support each hybrid edge: percentage of bootstrap trees with an edge from the same sister clade to the same hybrid clade. Alternatively, we could show the bootstrap support for the full reticulation relationships in the network, one at each hybrid node (support for same hybrid with same sister clades):</p>
<pre><code class="julia">plot(net1, nodeLabel=BSn[[:hybridnode,:BS_hybrid_samesisters]])
</code></pre>

<p>On a different plot, we can show the bootstrap support for hybrid clades, shown on the parent edge of each node with positive hybrid support:</p>
<pre><code class="julia">plot(net1, edgeLabel=BSn[BSn[:BS_hybrid].&gt;0, [:edge,:BS_hybrid]])
</code></pre>

<p>or plot the support for minor sister clades (shown along parent edge, and filtered to those with sister support &gt; 5%):</p>
<pre><code class="julia">plot(net1, edgeLabel=BSn[BSn[:BS_minor_sister].&gt;5, [:edge,:BS_minor_sister]])
</code></pre>

<p>To plot the same values next to the associated nodes, rather than edges, we use the option <code>nodeLabel</code> and we select the column <code>node</code> or <code>hybridnode</code>:</p>
<pre><code class="julia">plot(net1, nodeLabel=BSn[BSn[:BS_hybrid].&gt;0, [:hybridnode,:BS_hybrid]])
plot(net1, nodeLabel=BSn[BSn[:BS_minor_sister].&gt;5, [:node,:BS_minor_sister]])
plot(net1, nodeLabel=BSn[BSn[:BS_major_sister].&gt;5, [:node,:BS_major_sister]])
</code></pre>

<p>The estimated heritability γ on hybrid edges in the reference network, when present in a bootstrap network, was also extracted:</p>
<pre><code class="julia">BSgam
</code></pre>

<p>γ=0 values are for bootstrap replicates that did not have the edge in their network. Basic summaries on γ values for a given edge, say the minor parent, could be obtained like this:</p>
<pre><code class="julia">minimum(BSgam[:,2])
maximum(BSgam[:,2])
mean(BSgam[:,2])
std(BSgam[:,2])
</code></pre>
          <aside class="copyright" role="note">
            
            Documentation built with
            <a href="http://www.mkdocs.org" target="_blank">MkDocs</a>
            using the
            <a href="http://squidfunk.github.io/mkdocs-material/" target="_blank">
              Material
            </a>
            theme.
          </aside>
          
            <footer class="footer">
              
  <nav class="pagination" aria-label="Footer">
    <div class="previous">
      
        <a href="../expectedCFs/" title="Extract Expected CFs">
          <span class="direction">
            Previous
          </span>
          <div class="page">
            <div class="button button-previous" role="button" aria-label="Previous">
              <i class="icon icon-back"></i>
            </div>
            <div class="stretch">
              <div class="title">
                Extract Expected CFs
              </div>
            </div>
          </div>
        </a>
      
    </div>
    <div class="next">
      
        <a href="../multiplealleles/" title="Multiple Alleles">
          <span class="direction">
            Next
          </span>
          <div class="page">
            <div class="stretch">
              <div class="title">
                Multiple Alleles
              </div>
            </div>
            <div class="button button-next" role="button" aria-label="Next">
              <i class="icon icon-forward"></i>
            </div>
          </div>
        </a>
      
    </div>
  </nav>

            </footer>
          
        </div>
      </article>
      <div class="results" role="status" aria-live="polite">
        <div class="scrollable">
          <div class="wrapper">
            <div class="meta"></div>
            <div class="list"></div>
          </div>
        </div>
      </div>
    </main>
    <script>
      var base_url = '../..';
      var repo_id  = 'crsl4/PhyloNetworks.jl';
    </script>
    <script src="../../assets/javascripts/application-997097ee0c.js"></script>
    
      <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
      <script src="../../assets/mathjaxhelper.js"></script>
    
    
  </body>
</html>